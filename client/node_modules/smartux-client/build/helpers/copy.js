let fs = require('fs-extra');
let path = require('path');

module.exports.custom = function (context) {
  [
    '/config.xml',
    '/src/application.json',
    '/src/screens.json',
    '/src/screenModels.json',
    '/src/published.json'
  ].forEach(file => {
    let src = path.join(context.rootDir, file);
    if (fs.existsSync(src)) {
      let dest = path.join(context.wwwDir, file.split('/').pop());
      fs.copySync(src, dest);
    }
  });

  let mocksSrc = path.join(context.rootDir, '/src/mocks');
  let mocksDest = path.join(context.wwwDir, '/mocks');
  fs.copySync(mocksSrc, mocksDest, {filter: filterTs});

  // Copy components build styles
  let componentStylesSrc = path.join(context.rootDir, 'node_modules/components/components.css');
  let componentStylesDest = path.join(context.wwwDir, '/build/components.css');
  fs.copySync(componentStylesSrc, componentStylesDest);

  // Copy font-awesome fonts
  let fontAwesomeSrc = path.join(context.rootDir, 'node_modules/font-awesome/fonts/');
  let fontAwesomeDest = path.join(context.wwwDir, '/assets/fonts/');
  fs.copySync(fontAwesomeSrc, fontAwesomeDest);
};

//-----------------------------------------------

function filterTs(src) {
  return path.extname(src) !== '.ts';
}
